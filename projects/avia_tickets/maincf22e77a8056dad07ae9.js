!function(e){function t(t){for(var r,o,c=t[0],s=t[1],u=t[2],f=0,d=[];f<c.length;f++)o=c[f],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&d.push(i[o][0]),i[o]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);for(l&&l(t);d.length;)d.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,c=1;c<n.length;c++){var s=n[c];0!==i[s]&&(r=!1)}r&&(a.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},i={0:0},a=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var c=window.webpackJsonp=window.webpackJsonp||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var l=s;a.push([338,2]),n()}({317:function(e,t,n){},338:function(e,t,n){"use strict";n.r(t),n(317),n(318),n(319);var r=document.querySelectorAll("select");M.FormSelect.init(r);var i=document.querySelectorAll(".autocomplete");M.Autocomplete.init(i,{limit:5});var a=document.querySelectorAll(".datepicker");M.Datepicker.init(a,{showClearBtn:!0,format:"yyyy-mm"});var o=document.querySelectorAll(".dropdown-trigger.favorit-dropdown");function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}M.Dropdown.init(o,{closeOnClick:!1});var s=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.select=document.getElementById("currency"),this.dictionary={USD:"$",UAH:"₴",EUR:"€"}}var t,n;return t=e,(n=[{key:"getCurrencySymbol",value:function(){return this.selectValue?this.dictionary[this.selectValue]:"₴"}},{key:"selectValue",get:function(){return this.select.value}}])&&c(t.prototype,n),e}());function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.container=document.querySelector(".dropdown-content")}var t,n,r;return t=e,r=[{key:"emptyMsgTemplate",value:function(){return'\n    <div class="tickets-empty-res-msg">\n      Ваш список избранных пуст!\n    </div>'}},{key:"flightTemplate",value:function(e){return'\n    <div class="favorite-item d-flex align-items-start">\n    <img\n      src="'.concat(e.airline_logo,'"\n      class="favorite-item-airline-img"\n    />\n    <div class="favorite-item-info d-flex flex-column">\n      <div\n        class="favorite-item-destination d-flex align-items-center"\n      >\n        <div class="d-flex align-items-center mr-auto">\n          <span class="favorite-item-city">').concat(e.origin_name,' </span>\n          <i class="medium material-icons">flight_takeoff</i>\n        </div>\n        <div class="d-flex align-items-center">\n          <i class="medium material-icons">flight_land</i>\n          <span class="favorite-item-city">').concat(e.destination_name,'</span>\n        </div>\n      </div>\n      <div class="ticket-time-price d-flex align-items-center">\n        <span class="ticket-time-departure">').concat(e.departure_at,'</span>\n        <span class="ticket-price ml-auto">').concat(e.currency).concat(e.price,'</span>\n      </div>\n      <div class="ticket-additional-info">\n        <span class="ticket-transfers">Пересадок: ').concat(e.transfers,'</span>\n        <span class="ticket-flight-number">Номер рейса: ').concat(e.flight_number,'</span>\n      </div>\n      <a\n        class="waves-effect waves-light btn-small red darken-3 delete-favorite ml-auto"\n        data-flight-number-del="').concat(e._id,'"\n        >Delete</a\n      >\n    </div> \n  </div>')}}],(n=[{key:"renderFlights",value:function(t){var n;this.clearContainer(),t.length?(n="",t.forEach((function(t){var r=e.flightTemplate(t,currency);n+=r})),this.container.insertAdjacentHTML("afterbegin",n)):this.showEmptyMsg()}},{key:"clearContainer",value:function(){this.container.innerHTML=""}},{key:"showEmptyMsg",value:function(){var t=e.emptyMsgTemplate();this.container.insertAdjacentHTML("afterbegin",t)}}])&&u(t.prototype,n),r&&u(t,r),e}());function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d=new(function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._form=document.forms["locations-control"],this.origin=document.getElementById("autocomplete-origin"),this.destination=document.getElementById("autocomplete-destination"),this.departDate=document.getElementById("datepicker-depart"),this.returnDate=document.getElementById("datepicker-return"),this.origiAutocomplete=t(this.origin),this.destinationAutocomplete=t(this.destination),this.departDatePicker=n(this.departDate),this.returnDatePicker=n(this.returnDate)}var t,n;return t=e,(n=[{key:"setAutocompleteData",value:function(e){this.origiAutocomplete.updateData(e),this.destinationAutocomplete.updateData(e)}},{key:"form",get:function(){return this._form}},{key:"originValue",get:function(){return this.origin.value}},{key:"destinationValue",get:function(){return this.destination.value}},{key:"departValue",get:function(){return this.departDate.value}},{key:"returnValue",get:function(){return this.returnDate.value}}])&&f(t.prototype,n),e}())((function(e){return M.Autocomplete.getInstance(e)}),(function(e){return M.Datepicker.getInstance(e)}));function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var v=new(function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.container=document.querySelector(".tickets-sections .row"),this.getCurrencySymbol=t.getCurrencySymbol.bind(t)}var t,n,r;return t=e,r=[{key:"emptyMsgTemplate",value:function(){return'\n    <div class="tickets-empty-res-msg">\n      По вашему запросу билетов не найдено.\n    </div>'}},{key:"ticketTemplate",value:function(e,t){return'\n    <div class="col s12 m6">\n      <div class="card ticket-card">\n        <div class="ticket-airline d-flex align-items-center">\n          <img\n            src="'.concat(e.airline_logo,'"\n            class="ticket-airline-img"\n          />\n          <span class="ticket-airline-name"\n            >').concat(e.airline_name,'</span\n          >\n        </div>\n        <div class="ticket-destination d-flex align-items-center">\n          <div class="d-flex align-items-center mr-auto">\n            <span class="ticket-city">').concat(e.origin_name,'</span>\n            <i class="medium material-icons">flight_takeoff</i>\n          </div>\n          <div class="d-flex align-items-center">\n            <i class="medium material-icons">flight_land</i>\n            <span class="ticket-city">').concat(e.destination_name,'</span>\n          </div>\n        </div>\n        <div class="ticket-time-price d-flex align-items-center">\n          <span class="ticket-time-departure">').concat(e.departure_at,'</span>\n          <span class="ticket-price ml-auto">').concat(t).concat(e.price,'</span>\n        </div>\n        <div class="ticket-additional-info">\n          <span class="ticket-transfers">Пересадок: ').concat(e.transfers,'</span>\n          <span class="ticket-flight-number">Номер рейса: ').concat(e.flight_number,'</span>\n        </div>\n        <a class="waves-effect waves-light btn-small green darken-1 add-favorite ml-auto" data-flight-number-add="').concat(e._id,'"> \n          Add to favorites\n        </a>\n      </div>\n    </div> ')}}],(n=[{key:"renderTickets",value:function(t){var n,r;this.clearContainer(),t.length?(n="",r=this.getCurrencySymbol(),t.forEach((function(t){var i=e.ticketTemplate(t,r);n+=i})),this.container.insertAdjacentHTML("afterbegin",n)):this.showEmptyMsg()}},{key:"clearContainer",value:function(){this.container.innerHTML=""}},{key:"showEmptyMsg",value:function(){var t=e.emptyMsgTemplate();this.container.insertAdjacentHTML("afterbegin",t)}}])&&p(t.prototype,n),r&&p(t,r),e}())(s),m=n(49),h=n.n(m);function y(e,t,n,r,i,a,o){try{var c=e[a](o),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,i)}function g(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){y(a,r,i,o,c,"next",e)}function c(e){y(a,r,i,o,c,"throw",e)}o(void 0)}))}}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var k=new(function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=t.url}var t,n,r,i,a,o;return t=e,(n=[{key:"countries",value:(o=g(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.a.get("".concat(this.url,"/countries"));case 3:return t=e.sent,e.abrupt("return",t.data);case 7:return e.prev=7,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",Promise.reject(e.t0));case 11:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(){return o.apply(this,arguments)})},{key:"cities",value:(a=g(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.a.get("".concat(this.url,"/cities"));case 3:return t=e.sent,e.abrupt("return",t.data);case 7:return e.prev=7,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",Promise.reject(e.t0));case 11:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(){return a.apply(this,arguments)})},{key:"prices",value:(i=g(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.a.get("".concat(this.url,"/prices/cheap"),{params:t});case 3:return n=e.sent,e.abrupt("return",n.data);case 7:return e.prev=7,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",Promise.reject(e.t0));case 11:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(e){return i.apply(this,arguments)})},{key:"airlines",value:(r=g(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.a.get("".concat(this.url,"/airlines"));case 3:return t=e.sent,e.abrupt("return",t.data);case 7:return e.prev=7,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",Promise.reject(e.t0));case 11:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(){return r.apply(this,arguments)})}])&&b(t.prototype,n),e}())({url:"https://aviasales-api.herokuapp.com"}),w=n(341);function O(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)),r}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){C(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function x(e,t,n,r,i,a,o){try{var c=e[a](o),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,i)}function P(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){x(a,r,i,o,c,"next",e)}function c(e){x(a,r,i,o,c,"throw",e)}o(void 0)}))}}function T(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var A=new(function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.api=t,this.countries=null,this.cities=null,this.shortCitiesList=null,this.airlines=null,this.lastSearch=null,this.formatDate=n.formatDate,this.getCurrencySymbol=s.getCurrencySymbol.bind(s)}var t,n,r,i;return t=e,(n=[{key:"init",value:(i=P(regeneratorRuntime.mark((function e(){var t,n,r,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.api.countries(),this.api.cities(),this.api.airlines()]);case 2:return t=e.sent,n=_(t,3),r=n[0],i=n[1],a=n[2],this.countries=this.serializeCountries(r),this.cities=this.serializeCities(i),this.shortCitiesList=this.createShortCitiesList(this.cities),this.airlines=this.serializeAirlines(a),e.abrupt("return",this);case 9:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"createShortCitiesList",value:function(e){return Object.values(e).reduce((function(e,t){return e[t.full_name]=null,e}),{})}},{key:"serializeCountries",value:function(e){return e.reduce((function(e,t){return e[t.code]=t,e}),{})}},{key:"serializeCities",value:function(e){var t=this;return e.reduce((function(e,n){n.name=n.name||n.name_translations.en;var r=t.getCountryNameByCode(n.country_code),i=n.name||n.name_translations.en,a="".concat(i,", ").concat(r);return e[n.code]=j(j({},n),{},{country_name:r,full_name:a}),e}),{})}},{key:"serializeAirlines",value:function(e){return e.reduce((function(e,t){return t.name=t.name||t.name_translations.en,t.logo="http://pics.avs.io/200/200/".concat(t.code,".png"),e[t.code]=t,e}),{})}},{key:"getCountryNameByCode",value:function(e){return this.countries[e].name}},{key:"getCityCodeByKey",value:function(e){return Object.values(this.cities).find((function(t){return t.full_name===e})).code}},{key:"getAirlineNameByCode",value:function(e){return this.airlines[e]?this.airlines[e].name:""}},{key:"getAirlineLogoeByCode",value:function(e){return this.airlines[e]?this.airlines[e].logo:""}},{key:"getCityNameByCode",value:function(e){return this.cities[e].name}},{key:"fetcthTickets",value:(r=P(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.prices(t);case 2:n=e.sent,this.lastSearch=this.serializeTickets(n.data);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"serializeTickets",value:function(e){var t=this;return Object.values(e).map((function(e){return j(j({},e),{},{origin_name:t.getCityNameByCode(e.origin),destination_name:t.getCityNameByCode(e.destination),airline_logo:t.getAirlineLogoeByCode(e.airline),airline_name:t.getAirlineNameByCode(e.airline),departure_at:t.formatDate(e.departure_at,"dd MMM yyy hh:mm"),return_at:t.formatDate(e.return_at,"dd MMM yyy hh:mm"),currency:t.getCurrencySymbol(),_id:"".concat(e.flight_number).concat(e.departure_at)})}))}}])&&T(t.prototype,n),e}())(k,{formatDate:function(e,t){var n=new Date(e);return Object(w.a)(n,t)}},s);function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var L=new(function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.locations=t,this.findedTickets=null,this.favoritObj=null,this.favoritList=null}var t,n;return t=e,(n=[{key:"init",value:function(){var e=localStorage.getItem("favorit-flights");this.favoritObj=JSON.parse(e)||{},this.favoritList=this.getFavoritList(this.favoritObj)}},{key:"getFavoritList",value:function(e){return Object.values(e)}},{key:"serializeFindedTickets",value:function(e){return e.reduce((function(e,t){return e[t._id]=t,e}),{})}},{key:"add",value:function(e){this.findedTickets=this.serializeFindedTickets(this.locations.lastSearch),this.favoritObj.hasOwnProperty(e)||(this.favoritObj[e]=this.findedTickets[e],this.favoritList=this.getFavoritList(this.favoritObj),localStorage.setItem("favorit-flights",JSON.stringify(this.favoritObj)))}},{key:"remove",value:function(e){delete this.favoritObj[e],this.favoritList=this.getFavoritList(this.favoritObj),localStorage.setItem("favorit-flights",JSON.stringify(this.favoritObj))}}])&&D(t.prototype,n),e}())(A);function E(e,t,n,r,i,a,o){try{var c=e[a](o),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,i)}function B(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){E(a,r,i,o,c,"next",e)}function c(e){E(a,r,i,o,c,"throw",e)}o(void 0)}))}}document.addEventListener("DOMContentLoaded",(function(){!function(){r.apply(this,arguments)}();var e=d.form,t=l.container,n=document.querySelector(".tickets-sections");function r(){return(r=B(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return L.init(),l.renderFlights(L.favoritList),e.next=4,A.init();case 4:d.setAutocompleteData(A.shortCitiesList);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function i(){return(i=B(regeneratorRuntime.mark((function e(){var t,n,r,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=A.getCityCodeByKey(d.originValue),n=A.getCityCodeByKey(d.destinationValue),r=d.departValue,i=d.returnValue,a=s.selectValue||"UAH",e.next=7,A.fetcthTickets({origin:t,destination:n,depart_date:r,return_date:i,currency:a});case 7:v.renderTickets(A.lastSearch);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}e.addEventListener("submit",(function(e){e.preventDefault(),function(){i.apply(this,arguments)}()})),n.addEventListener("click",(function(e){var t;e.target.className.includes("add-favorite")&&(t=e.target.dataset.flightNumberAdd,L.add(t),l.renderFlights(L.favoritList))})),t.addEventListener("click",(function(e){var t;e.target.className.includes("delete-favorite")&&(t=e.target.dataset.flightNumberDel,L.remove(t),l.renderFlights(L.favoritList))}))}))}});